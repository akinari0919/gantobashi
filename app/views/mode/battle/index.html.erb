<main>
  <div class='top-contents mt-3'>
    <p class='title-contents mb-2'>Battle Index</p>
    <table>
      <tr>
        <th class='width20'>Name</th>
        <th class='width30'>Image</th>
        <th class='width10'>Level</th>
        <th class='width30'></th>
      </tr>
      <% @users.each do |user| %>
        <% gfp = user.glaring_face_photos.find_by(main_choiced: true) %>
        <% if gfp.present? %>
          <tr class='enemy-table'>
            <td><%= user.name %></td>
            <td><img src="data:image/jpeg;base64,<%="#{gfp.image}"%>" width="100" height="100" /></td>
            <td><%= "★×#{gfp.defense_win_count}" %></td>
            <% if gfp.beated_by?(current_user) %>
              <td><%= link_to 'Done', mode_battle_path(user), class:"button-43" %></td>
            <% else %>
              <td><%= link_to 'Show', mode_battle_path(user), class:"button-43" %></td>
            <% end %>
          </tr>
        <% else %>
          <p>No Users</p>
        <% end %>
      <% end %>
    </table>
    <%= paginate @users %>
  </div>
</main>
